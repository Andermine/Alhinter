id: WATERY_WILDS
type: BIOME
vanilla: minecraft:savanna
extends: [ CARVING_LAND, BASE ]

color: $biomes/colors.yml:SAVANNA

colors:
  grass: 0x82BC6D
  foliage: 0x65A949
  water: 0xE4ECF
  water-fog: 0xC0D8FF
  
tags:
  - USE_RIVER

vars: &variables
  base: 63
  height: 12
  terraceCount: 8
  terraceHeight: 40
  pathHeight: 20

terrain:
  sampler:
    dimensions: 3
    type: EXPRESSION
    variables: *variables
    expression: |
      -y + base + max(height * surfaceOffset(x,z)
      + terrace(max(plateous(x,z) - 0.5, 0) * terraceCount, 999) / terraceCount * terraceHeight,
      paths(x,z) * pathHeight - 1)
    functions:
      terrace:
        arguments: [x, terraceStrength]
        expression: round(x) + 0.5 * (2*(x - round(x)))^terraceStrength
    samplers:
      paths:
        dimensions: 2
        type: EXPRESSION
        variables: *variables
        expression: |
          min(-abs(basic(x,z)) + 0.2, 0.05)
        samplers:
          basic:
            dimensions: 2
            type: OPEN_SIMPLEX_2
            frequency: 0.012
      plateous:
        dimensions: 2
        type: OPEN_SIMPLEX_2S
        frequency: 0.009
        salt: 4
      surfaceOffset:
        dimensions: 2
        type: FBM
        sampler:
          type: OPEN_SIMPLEX_2S
          frequency: 0.006
        octaves: 3
        lacunarity: 2.4
        gain: 0.5

palette:
  - ARID: 319
  - SAVANNA_BRIDGES: 62
  - MUDDY_BEACH: 61
  - << meta.yml:palette-bottom

slant:
  - threshold: 0.75
    palette:
      - BLOCK:minecraft:stone: 319
      - << meta.yml:palette-bottom

features:
  landforms:
    - RED_ROCKS
  trees:
    - ACACIA_TREES
  flora:
    - GRASS
    - TALL_GRASS
    - CACTUS_SPARSE
    - MANGROVE_SEAGRASS
    - JUNGLE_BUSHES
    - POPPY_PATCH
    - MELON_PATCHES
    - OXEYE_DAISY_PATCH
    - CORNFLOWER_PATCH
    - ALLIUM_PATCH